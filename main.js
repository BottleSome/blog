/*FrontMainJS - SomeBottle*/
/*q.js*/
var md;if(typeof $!=="object"){$=new Object;$.ls=new Array;$.lss="";$.loadset=new Object;$.aj=function(p,d,sf,m,proxy,as){if(p!=="false"&&p){var xhr=new XMLHttpRequest;var hm="";for(var ap in d)hm=hm+ap+"\x3d"+d[ap]+"\x26";if(proxy!=="")p=proxy+p;hm=hm.substring(0,hm.length-1);if(m=="get")xhr.open("get",p,as);else xhr.open("post",p,as);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(hm);xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200)sf.success(xhr.responseText,p);else if(xhr.readyState==4&&xhr.status!==200)sf.failed(xhr.status,p)};if(!as)if(xhr.responseText!==undefined)sf.success(xhr.responseText,p);else sf.failed(xhr.status,p)}};var SC=function(e){if(e=="body")return document.body;else if(e=="html")return document.getElementsByTagName("html")[0];else return document.getElementById(e)};$.script=function(url){if(!$.scripturl)$.scripturl=[];var script=document.createElement("script");var exist=false;for(var up in $.ls)if($.ls[up]==url){exist=true;break}if(!exist&&$.scripturl.indexOf(url)==-1){$.ls[$.ls.length]=url;script.type="text/javascript";script.src=url;$.scripturl.push(url);document.body.appendChild(script)}};$.ht=function(h,e,scinclude){scinclude=scinclude===undefined?true:scinclude;var ht=SC(e);if(!ht){console.log("Unable to find the Element:"+e);return false}ht.innerHTML=h;os=ht.getElementsByTagName("script");var scr="";for(var o=0;o<os.length;o++)if(os[o].src!==undefined&&os[o].src!==null&&os[o].src!=="")$.script(os[o].src);else try{var h=os[o].innerHTML;if(scinclude){h=B.r(h,"/*","");h=B.r(h,"*/","")}eval(h)}catch(e$0){console.log("Page script Error: "+e$0.message)}};$.tr=function(url){var a=url;b=a.split("?");if(b[1])return b[0];else return a};$.dt=function(v){if(Number(v)>=1E7){var dt=String(v),md=dt.slice(-4),d=md.slice(-2),m=md.substring(0,2),y=dt.replace(md,""),changed=y+"-"+m+"-"+d;return changed}else return v};$.rmhead=function(html){var tp=document.createElement("html");tp.innerHTML=html;var head=tp.getElementsByTagName("head")[0];head.parentNode.removeChild(head);return[tp.innerHTML,head.innerHTML]};$.addhead=function(hd){var e=SC("html"),head=e.getElementsByTagName("head")[0],clothstyle=head.getElementsByTagName("clothstyle");if(clothstyle.length<=0){var cloth=document.createElement("clothstyle");cloth.innerHTML=hd;head.appendChild(cloth)}else clothstyle[0].innerHTML=hd};$.ldparse=function(ld){var ht=document.createElement("html");ht.innerHTML=ld;var obj=ht.getElementsByTagName("loadset"),set=obj?JSON.parse(obj[0].innerHTML):false;if(set)$.loadset=set;else console.log("Failed to initialize loading page.")};$.ecls=function(v,clsv,rmv,returne){rmv=rmv===undefined?false:rmv;returne=returne===undefined?false:returne;var ps=v.split(":"),content=document.getElementsByTagName("html")[0],es;switch(ps[0]){case "id":es=document.getElementById(ps[1]);break;case "class":es=content.getElementsByClassName(ps[1]);break;case "tag":es=content.getElementsByTagName(ps[1]);break}if(returne)return es;if(!(es instanceof Element))for(var i in es)es[i]instanceof Element?rmv?es[i].classList.remove(clsv):es[i].classList.add(clsv):es=es;else rmv?es.classList.remove(clsv):es.classList.add(clsv)}}if(!B){if(localStorage["obottle-ldpage"]){var e=SC("html").innerHTML;$.ldparse(localStorage["obottle-ldpage"]);SC("html").innerHTML=e.replace("\x3c!--[LoadingArea]--\x3e",localStorage["obottle-ldpage"])}$.aj("./loading.html","",{success:function(m,p){B.hr("\x3c!--[LoadingArea]--\x3e",m);localStorage["obottle-ldpage"]=m;$.ldparse(m)},failed:function(m){console.log("LoadingPage Load Failed")}},"get","",true);$.script("https://cdn.jsdelivr.net/gh/BottleSome/blog/library.js");window.htmls=new Object;var B={moreperpage:0,r:function(a,o,p,g){g=g===undefined?true:g;if(g)while(a.indexOf(o)!==-1)a=a.replace(o,p);else a=a.replace(o,p);return a},navlist:{statu:false,conf:{}},navcurrent:function(v){v=v===undefined?"":v;return((-1==v.indexOf("http")?v=v:v.replace(window.location.protocol+"//"+window.location.hostname,""))||window.location.pathname).replace(".html","")},navcheck:function(){var c=document.body,o=this,cl=o.navlist.conf;if(o.navlist.statu){var e=c.getElementsByClassName(cl.navclass),path=o.navcurrent();for(var i in e){var p=o.navcurrent(e[i].href);if(path==p&&e[i]instanceof Element)e[i].classList.add(cl.activeclass);else if(e[i]instanceof Element)e[i].classList.contains(cl.activeclass)?e[i].classList.remove(cl.activeclass):p=p}}},nav:function(v){var o=this;o.navlist.statu=true;o.navlist.conf=v},scrolltop:function(maxspeed,minspeed){var nt=document.body.scrollTop;var stages=Math.floor(parseInt(nt)/3);var v1=maxspeed;var vmin=minspeed;var a1=Math.pow(v1,2)/(stages*2);var vn=0;var st=setInterval(function(){var ntnow=document.body.scrollTop;if(parseInt(ntnow)>stages*2){vn+=a1;document.body.scrollTop=parseInt(ntnow)-vn}else if(parseInt(ntnow)>stages)document.body.scrollTop=parseInt(ntnow)-vn;else if(parseInt(ntnow)<=stages){vn-=a1;if(vn<=vmin)vn=vmin;if(parseInt(ntnow)<=0){document.body.scrollTop=0;clearInterval(st)}else document.body.scrollTop=parseInt(ntnow)-vn}},10)},hc:function(v){v=v.replace(/&amp;/g,"\x26").replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e");return v},hr:function(o,p){var e=SC("html").innerHTML;SC("html").innerHTML=this.r(e,o,p)},unrnspace:function(h){h=h.replace(/{{s}}/g," ");h=h.replace(/{{rn}}/g,"\r\n");h=h.replace(/{{n}}/g,"\n");return h},deltemptags:function(h){return h.replace(/\{\((.*?)\)\}/g,"")},preventscript:function(){var e=SC("html");var sc=e.getElementsByTagName("script");for(var i in sc)if(sc[i].src&&$.scripturl.indexOf(sc[i].src)==-1)$.scripturl.push(sc[i].src)},dehtml:function(h){var temp=h.replace(/&amp;/g,"\x26").replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e").replace(/&nbsp;/g," ").replace(/&#39;/g,"'").replace(/&quot;/g,'"');return temp},gt:function(p1,p2,ct){ct=ct===undefined?false:ct;var e;if(!ct)e=SC("html").innerHTML;else e=ct;try{var k=e.split(p1)[1];var d=k.split(p2)[0];return this.dehtml(d)}catch(e$1){return false}},lazypre:function(c){var i=document.createElement("div");i.innerHTML=c;var s=i.getElementsByTagName("img");for(var p in s)if(s[p].src){var sr=s[p].src;s[p].src="data:image/gif;base64,R0lGODlhkAGQAYAAAP///wAAACH5BAEAAAAALAAAAACQAZABAAL/hI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8YhMKpfMpvMJjUqn1Kr1is1qt9yu9wsOi8fksvmMTqvX7Lb7DY/L5/S6/Y7P6/f8vv8PGCg4SFhoeIiYqLjI2Oj4CBkpOUlZaXmJmam5ydnp+QkaKjpKWmp6ipqqusra6voKGys7S1tre4ubq7vL2+v7CxwsPExcbHyMnKy8zNzs/AwdLT1NXW19jZ2tvc3d7f0NHi4+Tl5ufo6err7O3u7+Dh8vP09fb3+Pn6+/z9/v/w8woMCBBAsaPIgwocKFDBs6fAgxosSJFCtavIgxo8aN/xw7evwIMqTIkSRLmjyJMqXKlSxbunwJM6bMmTRr2ryJM6fOnTx7+vwJNKjQoUSLGj2KNKnSpUybOn0KNarUqVSrWr2KNavWrVy7ev0KNqzYsWTLmj2LNq3atWzbun0LN67cuXTr2r2LN6/evXz7+v0LOLDgwYQLGz6MOLHixYwbO34MObLkyZQrW76MObPmzZw7e/4MOrTo0aRLmz6NOrXq1axbu34NO7bs2bRr276NO7fu3bx7+/4NPLjw4cSLGz+OPLny5cybO38OPbr06dSrW7+OPbv27dy7e/8OPrz48eTLmz+PPr369ezbu38PP778+fTr27+PP7/+/fz7+03/D2CAAg5IYIEGHohgggouyGCDDj4IYYQSTkhhhRZeiGGGGm7IYYcefghiiCKOSGKJJp6IYooqrshiiy6+CGOMMs5IY4023ohjjm0UAAA7";if(s[p].style.width!=="")sr=sr+"[width]"+s[p].style.width;s[p].setAttribute("data-src","[lazy]"+sr);s[p].style.width="100%"}return i.innerHTML},lazycheck:function(){var H=window.innerHeight;var S=document.documentElement.scrollTop||document.body.scrollTop;var es=document.getElementsByTagName("img");for(var i in es){var cty=es[i].offsetTop;if(H+S>cty){var lazy=es[i].getAttribute("data-src");if(lazy!=="undefined"&&lazy){es[i].setAttribute("data-src","");var mainsrc=lazy.split("[lazy]")[1];if(mainsrc.indexOf("[width]")!==-1){var sp=mainsrc.split("[width]");es[i].src=sp[0];es[i].style.width=sp[1]}else{es[i].src=lazy.split("[lazy]")[1];es[i].style.width="auto"}}}}},templonload:0,templateloaded:new Array,tpcheckstatu:false,loadstatu:false,tpcheck:function(){var ot=this,o=this;ot.tpcheckstatu=true;ot.loadshow();var pagetype=ot.gt("{(PageType)}","{(PageTypeEnd)}");if(!window.templjson)$.aj("template.json","",{success:function(m){window.templjson=JSON.parse(m);return ot.tpcheck()},failed:function(m){console.log("TemplateJson Load Failed.")}},"get","",true);else if(!window.mainjson&&window.templjson["usemain"].indexOf(pagetype)!==-1){if(!window.mainjsonrequest){window.mainjsonrequest=true;$.aj(window.templjson["mainjson"],"",{success:function(m){window.mainjson=JSON.parse(m.replace(/[\r\n]/g,""));ot.moreperpage=parseInt(window.mainjson["more_per_page"])},failed:function(m){console.log("MainJson Load Failed")}},"get","https://cdn.jsdelivr.net/gh/BottleSome/blog/",true)}setTimeout(function(){return o.tpcheck()},100)}else if(typeof showdown!=="object")setTimeout(function(){return o.tpcheck()},100);else if(!localStorage["obottle-ldpage"])setTimeout(function(){return o.tpcheck()},100);else{ot.preventscript();var j=window.templjson;j["necessary"].push(pagetype);if(pagetype==j["templatehtmls"]["postlist"])j["necessary"].push(j["templatehtmls"]["postitem"]);for(var i in j["necessary"])if(o.templateloaded.indexOf(j["necessary"][i])==-1){o.templonload+=1;var usecache=false;var cache=q("r","template-"+j["necessary"][i],"","","");if(cache["c"]){usecache=true;var p=j["necessary"][i];console.log("Template using cache:"+p);window.htmls[p]=cache["c"];o.templateloaded.push(p);o.templonload-=1}$.aj(j["necessary"][i],"",{success:function(m,p){window.htmls[p]=m;if(!usecache){o.templateloaded.push(p);o.templonload-=1;q("w","template-"+p,m,timestamp(),"")}else if(cache["c"]!==m)q("w","template-"+p,m,timestamp(),"");else q("e","template-"+p,"","",1)},failed:function(m){console.log("Necessary HTML Load Failed...")}},"get","",true)}var timer=setInterval(function(){if(o.templonload<=0){clearInterval(timer);o.renderer()}},200)}},itempage:0,switchpage:0,nowpage:0,realpage:1,searchw:"",hashexist:false,itempagefixer:function(){var ot=this;var tj=window.mainjson;var counter=1;for(var po in tj["dateindex"]){var nip=ot.itempage;var pid=po.replace("post","");var pt=tj["postindex"][pid];if(counter<=nip)if(pt["link"])ot.itempage+=1;counter+=1}ot.itempage-=1},cd:function(rc){var rst=rc;while(rst.indexOf("\x3cifcover\x3e")!==-1){var coverhtml=B.gt("\x3cifcover\x3e","\x3c/ifcover\x3e",rst);rst=B.r(rst,"\x3cifcover\x3e"+coverhtml+"\x3c/ifcover\x3e","")}return rst},renderer:function(){var ot=this;var j=window.templjson;md=new showdown.Converter;var cloth=window.htmls[j["templatehtmls"]["cloth"]];var main=window.htmls[j["templatehtmls"]["main"]];var comment=window.htmls[j["templatehtmls"]["comment"]];var pagetype=ot.gt("{(PageType)}","{(PageTypeEnd)}");var tj=window.mainjson;if(pagetype==j["templatehtmls"]["post"]){var content=ot.gt("{(PostContent)}","{(PostContentEnd)}");var title=ot.gt("{(PostTitle)}","{(PostTitleEnd)}");var date=ot.gt("{(PostDate)}","{(PostDateEnd)}");var tags=ot.gt("{(PostTag)}","{(PostTagEnd)}");var pid=ot.gt("{(PostID)}","{(PostIDEnd)}");var cover=ot.gt("{(PostCover)}","{(PostCoverEnd)}");var pagetitle=ot.gt("{(MainTitle)}","{(MainTitleEnd)}").replace(/<\/?.+?>/g,"");var post=window.htmls[j["templatehtmls"]["post"]];var render11=ot.r(post,"{[postcontent]}",ot.lazypre(md.makeHtml(ot.hc(ot.unrnspace(content.trim())))));var render12=ot.r(render11,"{[posttitle]}",title);var alltags=[];if(isNaN(date))tags="\u9875\u9762";else{alltags=tags.split(",");tags="";alltags.forEach(function(i,v){tags=tags+'\x3ca href\x3d"'+j["generatehtmls"]["tags"]+"#"+encodeURIComponent(i)+'" class\x3d"taglink"\x3e'+i+"\x3c/a\x3e,"});tags=tags.substr(0,tags.length-1)}var render13=ot.r(render12,"{[posttags]}",tags);var render14=ot.r(render13,"{[postdate]}",$.dt(date));var render2=ot.r(main,"{[contents]}",render14);var render3=ot.r(cloth,"{[main]}",render2);var render4=ot.r(render3,"{[title]}",pagetitle);var ghead=$.rmhead(render4);var render5=ot.r(ghead[0],"{[comments]}",comment);var render6=ot.r(render5,"{[pid]}",pid);render6=ot.r(render6,"{[pagetype]}",pagetype);render6=ot.r(render6,"{(PageType)}","\x3c!--[PageType]");render6=ot.r(render6,"{(PageTypeEnd)}","[PageTypeEnd]--\x3e");if(cover&&cover!=="none"&&cover!=="")render6=ot.r(render6,"{[postcover]}",cover);else render6=ot.cd(render6);if(isNaN(date)){var r7=render6.split("{(:PostEnd)}")[0]+"\x3c!--PostEnd--\x3e";var r8="\x3c!--Footer--\x3e"+render6.split("{(Footer:)}")[1];render6=r7+r8}$.ht(ot.deltemptags(render6),"container");$.addhead(ghead[1]);anichecker($.ecls($.loadset["listening"],"",false,true),function(){ot.lazycheck()});ot.loadhide()}else if(pagetype==j["templatehtmls"]["postlist"]){var content=ot.gt("{(PostContent)}","{(PostContentEnd)}");var pagetitle=ot.gt("{(MainTitle)}","{(MainTitleEnd)}").replace(/<\/?.+?>/g,"");var realtitle=pagetitle.replace("-","");var pt=window.htmls[j["templatehtmls"]["postlist"]];var render11=ot.r(pt,"{[postitems]}",md.makeHtml(ot.unrnspace(content.trim())));var render2=ot.r(main,"{[contents]}",render11);var render3=ot.r(cloth,"{[main]}",render2);var render4=ot.r(render3,"{[title]}",realtitle);var ghead=$.rmhead(render4);var render4=ot.r(ghead[0],"{[pagetype]}",pagetype);render4=ot.r(render4,"{(PageType)}","\x3c!--[PageType]");render4=ot.r(render4,"{(PageTypeEnd)}","[PageTypeEnd]--\x3e");ot.itempage=parseInt(tj["posts_per_page"]);ot.itempagefixer();$.ht(ot.deltemptags(render4),"container");$.addhead(ghead[1]);ot.loadhide();var timer=setInterval(function(){if(ot.gt("\x3c!--[PageType]","[PageTypeEnd]--\x3e")!==j["templatehtmls"]["postlist"]){PJAX.sel("container");PJAX.start();ot.switchpage=0;clearInterval(timer);return false}ot.indexpagechecker()},100)}else if(pagetype==j["templatehtmls"]["archives"]){var pagetitle=ot.gt("{(MainTitle)}","{(MainTitleEnd)}").replace(/<\/?.+?>/g,""),ar=window.htmls[j["templatehtmls"]["archives"]],archivemain=ot.gt("{(Archives)}","{(ArchivesEnd)}",ar),archivetemp=ot.gt("{(ArchiveTemplate)}","{(ArchiveTemplateEnd)}",ar),archiveitemtemp=ot.gt("{(ArchiveItemTemplate)}","{(ArchiveItemTemplateEnd)}",ar),din=tj["dateindex"],renderar="",renderarit="",year=0;for(var td in din){var t=din[td].toString().substring(0,4);if(t!==year){year=t;if(renderarit!=="")renderar=ot.r(renderar,"{[archiveitems]}",renderarit),renderarit="";renderar+=ot.r(archivetemp,"{[archiveyear]}",t)}var pid=td.replace("post",""),title=Base64.decode(tj["postindex"][pid]["title"]),date=tj["postindex"][pid]["date"],itemlink="";if(!tj["postindex"][pid]["link"])itemlink="post-"+pid+".html";else itemlink=tj["postindex"][pid]["link"];var itemrender=ot.r(archiveitemtemp,"{[archiveitemlink]}",itemlink),itemrender=ot.r(itemrender,"{[archiveitemtitle]}",title),itemrender=ot.r(itemrender,"{[archiveitemdate]}",$.dt(date));renderarit+=itemrender}if(renderarit!=="")renderar=ot.r(renderar,"{[archiveitems]}",renderarit);renderar+="\x3c/ul\x3e";var render11=ot.r(archivemain,"{[archives]}",renderar);var render2=ot.r(main,"{[contents]}",render11);var render3=ot.r(cloth,"{[main]}",render2);var render4=ot.r(render3,"{[title]}",pagetitle);var ghead=$.rmhead(render4);var render4=ot.r(ghead[0],"{[pagetype]}",pagetype);render4=ot.r(render4,"{(PageType)}","\x3c!--[PageType]");render4=ot.r(render4,"{(PageTypeEnd)}","[PageTypeEnd]--\x3e");$.ht(ot.deltemptags(render4),"container");$.addhead(ghead[1]);ot.loadhide()}else if(pagetype==j["templatehtmls"]["tags"]){var pagetitle=ot.gt("{(MainTitle)}","{(MainTitleEnd)}").replace(/<\/?.+?>/g,""),tgs=window.htmls[j["templatehtmls"]["tags"]],tagmain=ot.gt("{(Tags)}","{(TagsEnd)}",tgs),tagitemtemp=ot.gt("{(TagItemTemplate)}","{(TagItemTemplateEnd)}",tgs),href=$.tr(window.location.href),rendertg="",pts=tj["postindex"],tagarr=new Array;for(var i in pts){var t=pts[i]["tags"].split(",");t.forEach(function(item,index){if(item!==""&&tagarr.indexOf(item)==-1)tagarr.push(item)})}tagarr.forEach(function(item,index){var g=ot.r(tagitemtemp,"{[tagitemtitle]}",item);g=ot.r(g,"{[tagitemlink]}","#"+encodeURIComponent(item));rendertg+=g});ot.alltaghtml=rendertg;if(href.indexOf("#")!==-1){var pg=href.split("#")[1];ot.nowtag=pg;if(pg!=="alltags")rendertg="\x3cscript\x3eB.taguper('"+pg+"');PJAX.sel('container');PJAX.start();\x3c/script\x3e"}var timer=setInterval(function(){if(window.location.href.indexOf(j["generatehtmls"]["tags"])==-1&&window.location.href.indexOf(j["generatehtmls"]["tags"].replace(".html",""))==-1){PJAX.sel("container");PJAX.start();clearInterval(timer);return false}ot.tagpagechecker()},100);var render11=ot.r(tagmain,"{[tags]}",rendertg);var render2=ot.r(main,"{[contents]}",render11);var render3=ot.r(cloth,"{[main]}",render2);var render4=ot.r(render3,"{[title]}",pagetitle);var ghead=$.rmhead(render4);var render4=ot.r(ghead[0],"{[pagetype]}",pagetype);render4=ot.r(render4,"{(PageType)}","\x3c!--[PageType]");render4=ot.r(render4,"{(PageTypeEnd)}","[PageTypeEnd]--\x3e");$.ht(ot.deltemptags(render4),"container");$.addhead(ghead[1]);ot.loadhide()}ot.tpcheckstatu=false},nowtag:"",alltaghtml:"",taguper:function(tg){tg=decodeURIComponent(tg);var eh=SC("html").innerHTML,ot=this,j=window.templjson,tgs=window.htmls[j["templatehtmls"]["tags"]],taglisttemp=ot.gt("{(TagListTemplate)}","{(TagListTemplateEnd)}",tgs),taglistitemtemp=ot.gt("{(TagListItemTemplate)}","{(TagListItemTemplateEnd)}",tgs),tj=window.mainjson;var dti=tj["dateindex"];var pts=tj["postindex"];var postlist=new Array;var rendertgs="";for(var i in dti){var pid=i.replace("post","");if(pts[pid]["tags"].indexOf(tg)!==-1)postlist.push(pid)}rendertgs+="\x3cul\x3e";postlist.forEach(function(it,id){var post=pts[it];var lk="post-"+it+".html",date=$.dt(post["date"]);if(post["link"])lk=post["link"]+".html";var g=ot.r(taglistitemtemp,"{[taglistitemlink]}",lk);g=ot.r(g,"{[taglistitemtitle]}",Base64.decode(post["title"]));g=ot.r(g,"{[taglistitemdate]}",$.dt(date));rendertgs+=g});rendertgs=ot.r(taglisttemp,"{[taglist]}",rendertgs);rendertgs=ot.r(rendertgs,"{[tagcurrent]}",tg);SC("tags").innerHTML=rendertgs},tagpagechecker:function(){var ot=this;var eh=SC("html").innerHTML;var href=$.tr(window.location.href);if(href.indexOf("#")==-1){PJAX.pause();window.location.replace(href+"#alltags");PJAX.start()}else{var pg=href.split("#")[1];if(ot.nowtag!==pg){ot.nowtag=pg;if(pg=="alltags"){if(SC("tags"))SC("tags").innerHTML=ot.alltaghtml}else ot.taguper(pg);PJAX.start()}}},indexpagechecker:function(){var eh=SC("html").innerHTML;var j=window.templjson;var href=$.tr(decodeURIComponent(window.location.href));var tj=window.mainjson;var maxrender=parseInt(tj["posts_per_page"]);var ot=this;if(href.indexOf("#")!==-1){ot.hashexist=true;var pg=href.split("#")[1];if(href.indexOf("#!")==-1){if(!isNaN(pg)){var pnum=parseInt(pg)-1;if(ot.nowpage!==pnum){ot.searchw="";ot.nowpage=pnum;var allps=maxrender*pnum*ot.moreperpage;ot.itempage=allps;ot.itempagefixer();SC("postitems").innerHTML="";ot.more();ot.realpage=pnum+1;ot.switchpage=0}}}else{var rendertp="";var item=window.htmls[j["templatehtmls"]["postitem"]],ptitem=ot.gt("{(PostItem)}","{(PostItemEnd)}",item),noitem=ot.gt("{(NoItem)}","{(NoItemEnd)}",item);var v=href.split("#!")[1];if(v!==ot.searchw){var process=function(){if(SC("postitems")&&SC("morebtn")){window.scrollTo(0,0);SC("postitems").innerHTML=rendertp;SC("morebtn").style.display="none";PJAX.start()}else setTimeout(function(){return process()},500)};ot.searchw=v;var pt=tj["postindex"];for(var i in pt){var tt=Base64.decode(pt[i]["title"]).toLowerCase();var cc=Base64.decode(pt[i]["intro"]).toLowerCase();var dd=pt[i]["date"].toLowerCase();var tg=pt[i]["tags"].toLowerCase();v=v.toLowerCase();if(tt.indexOf(v)!==-1||cc.indexOf(v)!==-1||dd.indexOf(v)!==-1||tg.indexOf(v)!==-1){var render1=B.r(ptitem,"{[postitemtitle]}",tt);var render2=B.r(render1,"{[postitemintro]}",cc+"...");var render3=B.r(render2,"{[postitemdate]}",$.dt(dd));var render4;if(!pt[i]["link"])render4=B.r(render3,"{[postitemlink]}","post-"+i+".html");else render4=B.r(render3,"{[postitemlink]}",pt[i]["link"]+".html");if(pt[i]["cover"])render4=B.r(render4,"{[postcover]}",pt[i]["cover"]);else render4=ot.cd(render4);rendertp+=render4}}if(rendertp=="")rendertp=noitem;if(!ot.tpcheckstatu&&!ot.loadstatu)process()}if(ot.tpcheckstatu||ot.loadstatu)ot.searchw=""}}else{ot.searchw="";if(ot.hashexist){ot.realpage=1;ot.switchpage=0;ot.hashexist=false}}},loadshow:function(){this.loadstatu=true;if($.loadset["animations"]){var es=$.loadset["animations"]["in"],eo=$.loadset["animations"]["out"];for(var i in es)$.ecls(i,es[i]);for(var i in eo)$.ecls(i,eo[i],true)}},loadhide:function(){this.loadstatu=false;var es=$.loadset["animations"]["out"],eo=$.loadset["animations"]["in"];for(var i in es)$.ecls(i,es[i]);for(var i in eo)$.ecls(i,eo[i],true)},morehtmls:{},more:function(){var ot=this;var j=window.templjson;var start=ot.itempage+1;var counter=0;var itemid=0;var listrender="";var tj=window.mainjson;var item=window.htmls[j["templatehtmls"]["postitem"]],ptitem=ot.gt("{(PostItem)}","{(PostItemEnd)}",item),noitem=ot.gt("{(NoItem)}","{(NoItemEnd)}",item);var maxrender=parseInt(tj["posts_per_page"]);var end=start+maxrender;var postids=tj["dateindex"];var overpages=0;for(var i in postids)if(start<=itemid)if(counter<maxrender){var pid=i.replace("post","");var pt=tj["postindex"][pid];if(!pt["link"]){var render1=B.r(ptitem,"{[postitemtitle]}",Base64.decode(pt.title));var render2=B.r(render1,"{[postitemintro]}",Base64.decode(pt.intro)+"...");var render3=B.r(render2,"{[postitemdate]}",$.dt(pt.date));var render4=B.r(render3,"{[postitemlink]}","post-"+pid+".html");if(pt["cover"])render4=B.r(render4,"{[postcover]}",pt["cover"]);else render4=ot.cd(render4);listrender+=render4}else{ot.itempage+=1;counter-=1}counter+=1}else overpages+=1;else itemid+=1;if(listrender==""){listrender=noitem;SC("morebtn").style.display="none"}else SC("morebtn").style.display="block";ot.itempage=ot.itempage+maxrender;if(ot.switchpage>=ot.moreperpage-1){SC("postitems").innerHTML=listrender;ot.scrolltop(20,2);ot.switchpage=0;ot.realpage+=1;PJAX.pause();window.location.href="#"+ot.realpage}else{SC("postitems").innerHTML=SC("postitems").innerHTML+listrender;ot.switchpage+=1}PJAX.start()}};window.addEventListener("scroll",B.lazycheck,false);window.addEventListener("pjaxstart",function(){B.loadshow()},false);window.addEventListener("pjaxfinish",function(){B.loadhide()},false)}function anichecker(e,func){var ts="";var tss={"animation":"animationend","OAnimation":"oAnimationEnd","MozAnimation":"animationend","WebkitAnimation":"webkitAnimationEnd"};for(var i in tss)if(e.style[i]!==undefined)ts=tss[i];function doit(){func();e.removeEventListener(ts,doit)}e.addEventListener(ts,doit)}var mainhost=window.location.host;var dt=(new Date).getTime();if(PJAX==undefined||PJAX==null)var PJAX={index:window.history.state===null?1:window.history.state.page,PJAXStart:new CustomEvent("pjaxstart"),PJAXFinish:new CustomEvent("pjaxfinish"),LoadedPage:{},lasthref:window.location.href,preventurl:new Array,recenturl:"",replace:"",sel:function(r){this.replace=r},jump:function(href){var ehref=encodeURIComponent(href);var ts=this;var usecache=false;var e=ts.replace;if(e=="")e="container";var listener;if(ts.recenturl.indexOf("#")!==-1&&href.indexOf("#")!==-1)return false;else if(ts.recenturl.indexOf("#")==-1&&href.indexOf("#")!==-1)B.nowpage=0;window.dispatchEvent(ts.PJAXStart);anichecker($.ecls($.loadset["listening"],"",false,true),function(){window.scrollTo(0,0);if(ts.LoadedPage[ehref]){$.ht(ts.LoadedPage[ehref],e,false);anichecker($.ecls($.loadset["listening"],"",false,true),function(){window.dispatchEvent(ts.PJAXFinish)})}else{var cache=q("r",ehref,"","","");if(cache["c"]){usecache=true;$.ht(cache["c"],e,false)}$.aj(href,{},{success:function(m){ts.recenturl=href;ts.LoadedPage[ehref]=m;if(!usecache){$.ht(m,e,false);q("w",ehref,m,timestamp(),"")}else if(cache["c"]!==m){q("w",ehref,m,timestamp(),"");$.ht(m,e,false)}else q("e",ehref,"","",1);anichecker($.ecls($.loadset["listening"],"",false,true),function(){window.dispatchEvent(ts.PJAXFinish)})},failed:function(m){window.dispatchEvent(ts.PJAXFinish)}},"get","",true)}})},pjaxautojump:function(){if(window.location.href.indexOf(mainhost)!==-1)PJAX.jump(window.location.href)},start:function(){var ts=this;ts.recenturl=window.location.href;var p=document.getElementsByTagName("a");for(var i in p)if(typeof p[i].addEventListener=="function")p[i].addEventListener("click",function(e){if(ts.preventurl.indexOf(this.href)!==-1||!this.href||this.href=="")return true;else{window.history.pushState(null,null,this.href);e.preventDefault();ts.jump(this.href)}},false);window.addEventListener("popstate",PJAX.pjaxautojump,false)},pause:function(){window.removeEventListener("popstate",PJAX.pjaxautojump)},autoprevent:function(){var ts=this;var p=document.getElementsByTagName("a");var h=window.location.host;for(var i in p)if(p[i].href!==undefined)if(p[i].href.indexOf(h)==-1)ts.preventurl.push(p[i].href)}};function q(md,k,c,t,rt){if(typeof localStorage.obottle=="undefined")localStorage.obottle="{}";var timestamp=0,cache="",caches=JSON.parse(localStorage.obottle),rs=new Array;if(typeof caches[k]!=="undefined"){timestamp=caches[k].t;cache=caches[k].h}if(md=="w"){var caches=JSON.parse(localStorage.obottle);var cc=new Object;cc.h=c;cc.t=t;cc.rt=0;caches[k]=cc;try{localStorage.obottle=JSON.stringify(caches)}catch(e$2){for(var d in caches)if(Number(caches[d].rt)<=20||Number(t)-Number(caches[d].t)>=172800)delete caches[d];localStorage.obottle=JSON.stringify(caches)}}else if(md=="r"){rs["t"]=timestamp;rs["c"]=cache;return rs}else if(md=="e"){var caches=JSON.parse(localStorage.obottle);caches[k].rt=Number(caches[k].rt)+rt;localStorage.obottle=JSON.stringify(caches)}}function timestamp(){var a=(new Date).getTime();return a}B.tpcheck();